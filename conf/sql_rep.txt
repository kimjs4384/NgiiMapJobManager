<<<<<<< HEAD
data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00001 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160518_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000) as e on o.(bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn) = e.(bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160518_00001_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00002 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160518_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160518_00001_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160518_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160518_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00002' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00002' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160518_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00002' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00003 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160518_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160518_00001_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160518_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00003') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160518_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00003') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00003' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00003' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00003' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160518_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00003' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00004 , layer_nm : nf_l_a01000 

view :create view extjob.nf_l_a01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160518_00001' and layer_nm = 'nf_l_a01000') as ext left join nfsd.nf_l_a01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select rbid,rddv,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view) as o inner join (select rbid,rddv,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160518_00001_nf_l_a01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.rbid from same_data as a inner join extjob.nf_l_a01000_view as o on a.rbid = o.rbid ),receive as (select o.ogc_fid as receive_ogc_fid, a.rbid from same_data as a inner join extjob.RD20160518_00001_nf_l_a01000 as o on a.rbid = o.rbid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00004' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.rbid = receive.rbid
edit_geom_data : with attr_same_data as (select o.* from (select rbid,rddv from extjob.nf_l_a01000_view) as o inner join (select rbid,rddv from extjob.RD20160518_00001_nf_l_a01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,rbid,rddv from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00004') as s inner join extjob.nf_l_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_l_a01000_view as o on a.rbid = o.rbid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00004' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.rbid from geo_edit as e inner join extjob.nf_l_a01000_view as o on e.rbid = o.rbid) as origin, (select ogc_fid as receive_ogc_fid,e.rbid from geo_edit as e inner join extjob.RD20160518_00001_nf_l_a01000 as o on e.rbid = o.rbid) as edit where origin.rbid = edit.rbid
edit_feature_data : with same as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00004') as s inner join extjob.nf_l_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view except select * from same ), em as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160518_00001_nf_l_a01000 except select * from same ), geometry as ( select mbr_hash_12,geom_length from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_length = om.geom_length) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00004' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_length from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_length)=(o.mbr_hash_12,o.geom_length)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_length from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160518_00001_nf_l_a01000 ) as o on (geometry.mbr_hash_12,geometry.geom_length)=(o.mbr_hash_12,o.geom_length)) as receive where (origin.mbr_hash_12,origin.geom_length) = (receive.mbr_hash_12,receive.geom_length)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00004' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_l_a01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00004' and layer_nm = 'nf_l_a01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00004' as inspect_id, 'nf_l_a01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160518_00001_nf_l_a01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00004' and layer_nm = 'nf_l_a01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00005 , layer_nm : nf_p_a03111 

view :create view extjob.nf_p_a03111_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160518_00001' and layer_nm = 'nf_p_a03111') as ext left join nfsd.nf_p_a03111 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160518_00001_nf_p_a03111) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.ndid from same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ),receive as (select o.ogc_fid as receive_ogc_fid, a.ndid from same_data as a inner join extjob.RD20160518_00001_nf_p_a03111 as o on a.ndid = o.ndid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00005' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.ndid = receive.ndid
edit_geom_data : with attr_same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160518_00001_nf_p_a03111) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00005') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00005' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.ndid from geo_edit as e inner join extjob.nf_p_a03111_view as o on e.ndid = o.ndid) as origin, (select ogc_fid as receive_ogc_fid,e.ndid from geo_edit as e inner join extjob.RD20160518_00001_nf_p_a03111 as o on e.ndid = o.ndid) as edit where origin.ndid = edit.ndid
edit_feature_data : with same as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00005') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view except select * from same ), em as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160518_00001_nf_p_a03111 except select * from same ), geometry as ( select mbr_hash_12 from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00005' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view ) as o on geometry.mbr_hash_12= o.mbr_hash_12) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160518_00001_nf_p_a03111 ) as o on geometry.mbr_hash_12 = o.mbr_hash_12) as receive where origin.mbr_hash_12 = receive.mbr_hash_12
data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00007 , layer_nm : nf_p_a03111 

view :create view extjob.nf_p_a03111_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160518_00001' and layer_nm = 'nf_p_a03111') as ext left join nfsd.nf_p_a03111 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160518_00001_nf_p_a03111) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.ndid from same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ),receive as (select o.ogc_fid as receive_ogc_fid, a.ndid from same_data as a inner join extjob.RD20160518_00001_nf_p_a03111 as o on a.ndid = o.ndid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00007' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.ndid = receive.ndid
edit_geom_data : with attr_same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160518_00001_nf_p_a03111) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00007') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00007' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.ndid from geo_edit as e inner join extjob.nf_p_a03111_view as o on e.ndid = o.ndid) as origin, (select ogc_fid as receive_ogc_fid,e.ndid from geo_edit as e inner join extjob.RD20160518_00001_nf_p_a03111 as o on e.ndid = o.ndid) as edit where origin.ndid = edit.ndid
edit_feature_data : with same as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00007') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view except select * from same ), em as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160518_00001_nf_p_a03111 except select * from same ), geometry as ( select mbr_hash_12 from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00007' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view ) as o on geometry.mbr_hash_12= o.mbr_hash_12) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160518_00001_nf_p_a03111 ) as o on geometry.mbr_hash_12 = o.mbr_hash_12) as receive where origin.mbr_hash_12 = receive.mbr_hash_12
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00007' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_p_a03111_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00007' and layer_nm = 'nf_p_a03111' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00007' as inspect_id, 'nf_p_a03111' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160518_00001_nf_p_a03111 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00007' and layer_nm = 'nf_p_a03111' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00008 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160518_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000) as e on o.(bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,mbr_hash_12,geom_area) = e.(bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,mbr_hash_12,geom_area) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160518_00001_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00008' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00010 , layer_nm : nf_a_b01000

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160518_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160518_00001_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160518_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00010') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160518_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00010') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00010' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00010' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160518_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00010' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00012 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160518_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000) as e on (o.*) = (e.*) ),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160518_00001_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00012' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160518_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00012') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00012' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160518_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00012') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00012' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00012' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00012' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00012' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160518_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00012' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00014 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160518_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and o.geom_area between e.geom_area*0.95 and e.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160518_00001_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160518_00001_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00014' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160518_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00014') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00014' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160518_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00014') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00014' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00014' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00014' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00014' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160518_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00014' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00015 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160518_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160518_00001_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160518_00001_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00015' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160518_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00015') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00015' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160518_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00015') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00015' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160518_00001_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00015' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00015' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00015' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160518_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00015' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00016 , layer_nm : nf_l_a01000 

view :create view extjob.nf_l_a01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160518_00001' and layer_nm = 'nf_l_a01000') as ext left join nfsd.nf_l_a01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select rbid,rddv,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view) as o inner join (select rbid,rddv,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160518_00001_nf_l_a01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_length between o.geom_length*0.95 and o.geom_length*1.05 ),same_data as (select o.* from (select rbid,rddv from geom_same_data) as o inner join (select rbid,rddv from extjob.RD20160518_00001_nf_l_a01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.rbid from same_data as a inner join extjob.nf_l_a01000_view as o on a.rbid = o.rbid ),receive as (select o.ogc_fid as receive_ogc_fid, a.rbid from same_data as a inner join extjob.RD20160518_00001_nf_l_a01000 as o on a.rbid = o.rbid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00016' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.rbid = receive.rbid
edit_geom_data : with attr_same_data as (select o.* from (select rbid,rddv from extjob.nf_l_a01000_view) as o inner join (select rbid,rddv from extjob.RD20160518_00001_nf_l_a01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,rbid,rddv from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00016') as s inner join extjob.nf_l_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_l_a01000_view as o on a.rbid = o.rbid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00016' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.rbid from geo_edit as e inner join extjob.nf_l_a01000_view as o on e.rbid = o.rbid) as origin, (select ogc_fid as receive_ogc_fid,e.rbid from geo_edit as e inner join extjob.RD20160518_00001_nf_l_a01000 as o on e.rbid = o.rbid) as edit where origin.rbid = edit.rbid
edit_feature_data : with same as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00016') as s inner join extjob.nf_l_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view except select * from same ), em as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160518_00001_nf_l_a01000 except select * from same ), geometry as ( select mbr_hash_12,geom_length from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_length = om.geom_length) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00016' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_length from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_length)=(o.mbr_hash_12,o.geom_length)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_length from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160518_00001_nf_l_a01000 ) as o on (geometry.mbr_hash_12,geometry.geom_length)=(o.mbr_hash_12,o.geom_length)) as receive where (origin.mbr_hash_12,origin.geom_length) = (receive.mbr_hash_12,receive.geom_length)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00016' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_l_a01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00016' and layer_nm = 'nf_l_a01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00016' as inspect_id, 'nf_l_a01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160518_00001_nf_l_a01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00016' and layer_nm = 'nf_l_a01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00017 , layer_nm : nf_p_a03111 

view :create view extjob.nf_p_a03111_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160518_00001' and layer_nm = 'nf_p_a03111') as ext left join nfsd.nf_p_a03111 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160518_00001_nf_p_a03111) as e on o.mbr_hash_12 = e.mbr_hash_12  ),same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from geom_same_data) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160518_00001_nf_p_a03111) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.ndid from same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ),receive as (select o.ogc_fid as receive_ogc_fid, a.ndid from same_data as a inner join extjob.RD20160518_00001_nf_p_a03111 as o on a.ndid = o.ndid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00017' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.ndid = receive.ndid
data : PyQt4.QtCore.QDate(2016, 5, 18) , inspect_id : AD20160518_00019 , layer_nm : nf_p_a03111 

view :create view extjob.nf_p_a03111_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160518_00001' and layer_nm = 'nf_p_a03111') as ext left join nfsd.nf_p_a03111 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160518_00001_nf_p_a03111) as e on o.mbr_hash_12 = e.mbr_hash_12 and o.ndid = e.ndid ),same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from geom_same_data) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160518_00001_nf_p_a03111) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.ndid from same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ),receive as (select o.ogc_fid as receive_ogc_fid, a.ndid from same_data as a inner join extjob.RD20160518_00001_nf_p_a03111 as o on a.ndid = o.ndid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160518_00019' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.ndid = receive.ndid
edit_geom_data : with attr_same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160518_00001_nf_p_a03111) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00019') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00019' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.ndid from geo_edit as e inner join extjob.nf_p_a03111_view as o on e.ndid = o.ndid) as origin, (select ogc_fid as receive_ogc_fid,e.ndid from geo_edit as e inner join extjob.RD20160518_00001_nf_p_a03111 as o on e.ndid = o.ndid) as edit where origin.ndid = edit.ndid
edit_feature_data : with same as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160518_00019') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view except select * from same ), em as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160518_00001_nf_p_a03111 except select * from same ), geometry as ( select mbr_hash_12 from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00019' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view ) as o on geometry.mbr_hash_12= o.mbr_hash_12) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160518_00001_nf_p_a03111 ) as o on geometry.mbr_hash_12 = o.mbr_hash_12) as receive where origin.mbr_hash_12 = receive.mbr_hash_12
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160518_00019' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_p_a03111_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00019' and layer_nm = 'nf_p_a03111' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160518_00019' as inspect_id, 'nf_p_a03111' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160518_00001_nf_p_a03111 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160518_00019' and layer_nm = 'nf_p_a03111' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00001 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160519_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00001_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160519_00001_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160519_00001_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160519_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00001') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160519_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00001') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00001_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00001' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00001' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160519_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00001' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00002 , layer_nm : nf_l_a01000 

view :create view extjob.nf_l_a01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160519_00001' and layer_nm = 'nf_l_a01000') as ext left join nfsd.nf_l_a01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select rbid,rddv,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view) as o inner join (select rbid,rddv,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160519_00001_nf_l_a01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_length between o.geom_length*0.95 and o.geom_length*1.05 ),same_data as (select o.* from (select rbid,rddv from geom_same_data) as o inner join (select rbid,rddv from extjob.RD20160519_00001_nf_l_a01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.rbid from same_data as a inner join extjob.nf_l_a01000_view as o on a.rbid = o.rbid ),receive as (select o.ogc_fid as receive_ogc_fid, a.rbid from same_data as a inner join extjob.RD20160519_00001_nf_l_a01000 as o on a.rbid = o.rbid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00002' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.rbid = receive.rbid
edit_geom_data : with attr_same_data as (select o.* from (select rbid,rddv from extjob.nf_l_a01000_view) as o inner join (select rbid,rddv from extjob.RD20160519_00001_nf_l_a01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,rbid,rddv from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00002') as s inner join extjob.nf_l_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_l_a01000_view as o on a.rbid = o.rbid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00002' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.rbid from geo_edit as e inner join extjob.nf_l_a01000_view as o on e.rbid = o.rbid) as origin, (select ogc_fid as receive_ogc_fid,e.rbid from geo_edit as e inner join extjob.RD20160519_00001_nf_l_a01000 as o on e.rbid = o.rbid) as edit where origin.rbid = edit.rbid
edit_feature_data : with same as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00002') as s inner join extjob.nf_l_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view except select * from same ), em as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160519_00001_nf_l_a01000 except select * from same ), geometry as ( select mbr_hash_12,geom_length from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_length = om.geom_length) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00002' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_length from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_length)=(o.mbr_hash_12,o.geom_length)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_length from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160519_00001_nf_l_a01000 ) as o on (geometry.mbr_hash_12,geometry.geom_length)=(o.mbr_hash_12,o.geom_length)) as receive where (origin.mbr_hash_12,origin.geom_length) = (receive.mbr_hash_12,receive.geom_length)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00002' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_l_a01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00002' and layer_nm = 'nf_l_a01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00002' as inspect_id, 'nf_l_a01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160519_00001_nf_l_a01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00002' and layer_nm = 'nf_l_a01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00003 , layer_nm : nf_p_a03111 

view :create view extjob.nf_p_a03111_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160519_00001' and layer_nm = 'nf_p_a03111') as ext left join nfsd.nf_p_a03111 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160519_00001_nf_p_a03111) as e on o.mbr_hash_12 = e.mbr_hash_12 and o.ndid = e.ndid ),same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from geom_same_data) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160519_00001_nf_p_a03111) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.ndid from same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ),receive as (select o.ogc_fid as receive_ogc_fid, a.ndid from same_data as a inner join extjob.RD20160519_00001_nf_p_a03111 as o on a.ndid = o.ndid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00003' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.ndid = receive.ndid
edit_geom_data : with attr_same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160519_00001_nf_p_a03111) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00003') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00003' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.ndid from geo_edit as e inner join extjob.nf_p_a03111_view as o on e.ndid = o.ndid) as origin, (select ogc_fid as receive_ogc_fid,e.ndid from geo_edit as e inner join extjob.RD20160519_00001_nf_p_a03111 as o on e.ndid = o.ndid) as edit where origin.ndid = edit.ndid
edit_feature_data : with same as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00003') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view except select * from same ), em as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160519_00001_nf_p_a03111 except select * from same ), geometry as ( select mbr_hash_12 from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00003' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view ) as o on geometry.mbr_hash_12= o.mbr_hash_12) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160519_00001_nf_p_a03111 ) as o on geometry.mbr_hash_12 = o.mbr_hash_12) as receive where origin.mbr_hash_12 = receive.mbr_hash_12
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00003' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_p_a03111_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00003' and layer_nm = 'nf_p_a03111' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00003' as inspect_id, 'nf_p_a03111' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160519_00001_nf_p_a03111 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00003' and layer_nm = 'nf_p_a03111' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00004 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160519_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00001_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160519_00001_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160519_00001_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160519_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00004') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160519_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00004') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00001_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00004' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00004' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160519_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00004' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00005 , layer_nm : nf_l_a01000 

view :create view extjob.nf_l_a01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160519_00001' and layer_nm = 'nf_l_a01000') as ext left join nfsd.nf_l_a01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select rbid,rddv,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view) as o inner join (select rbid,rddv,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160519_00001_nf_l_a01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_length between o.geom_length*0.95 and o.geom_length*1.05 ),same_data as (select o.* from (select rbid,rddv from geom_same_data) as o inner join (select rbid,rddv from extjob.RD20160519_00001_nf_l_a01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.rbid from same_data as a inner join extjob.nf_l_a01000_view as o on a.rbid = o.rbid ),receive as (select o.ogc_fid as receive_ogc_fid, a.rbid from same_data as a inner join extjob.RD20160519_00001_nf_l_a01000 as o on a.rbid = o.rbid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00005' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.rbid = receive.rbid
edit_geom_data : with attr_same_data as (select o.* from (select rbid,rddv from extjob.nf_l_a01000_view) as o inner join (select rbid,rddv from extjob.RD20160519_00001_nf_l_a01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,rbid,rddv from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00005') as s inner join extjob.nf_l_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_l_a01000_view as o on a.rbid = o.rbid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00005' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.rbid from geo_edit as e inner join extjob.nf_l_a01000_view as o on e.rbid = o.rbid) as origin, (select ogc_fid as receive_ogc_fid,e.rbid from geo_edit as e inner join extjob.RD20160519_00001_nf_l_a01000 as o on e.rbid = o.rbid) as edit where origin.rbid = edit.rbid
edit_feature_data : with same as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00005') as s inner join extjob.nf_l_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view except select * from same ), em as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160519_00001_nf_l_a01000 except select * from same ), geometry as ( select mbr_hash_12,geom_length from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_length = om.geom_length) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00005' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_length from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_length)=(o.mbr_hash_12,o.geom_length)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_length from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160519_00001_nf_l_a01000 ) as o on (geometry.mbr_hash_12,geometry.geom_length)=(o.mbr_hash_12,o.geom_length)) as receive where (origin.mbr_hash_12,origin.geom_length) = (receive.mbr_hash_12,receive.geom_length)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00005' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_l_a01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00005' and layer_nm = 'nf_l_a01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00005' as inspect_id, 'nf_l_a01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160519_00001_nf_l_a01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00005' and layer_nm = 'nf_l_a01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00006 , layer_nm : nf_p_a03111 

view :create view extjob.nf_p_a03111_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160519_00001' and layer_nm = 'nf_p_a03111') as ext left join nfsd.nf_p_a03111 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160519_00001_nf_p_a03111) as e on o.mbr_hash_12 = e.mbr_hash_12 and o.ndid = e.ndid ),same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from geom_same_data) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160519_00001_nf_p_a03111) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.ndid from same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ),receive as (select o.ogc_fid as receive_ogc_fid, a.ndid from same_data as a inner join extjob.RD20160519_00001_nf_p_a03111 as o on a.ndid = o.ndid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00006' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.ndid = receive.ndid
edit_geom_data : with attr_same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160519_00001_nf_p_a03111) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00006') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00006' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.ndid from geo_edit as e inner join extjob.nf_p_a03111_view as o on e.ndid = o.ndid) as origin, (select ogc_fid as receive_ogc_fid,e.ndid from geo_edit as e inner join extjob.RD20160519_00001_nf_p_a03111 as o on e.ndid = o.ndid) as edit where origin.ndid = edit.ndid
edit_feature_data : with same as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00006') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view except select * from same ), em as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160519_00001_nf_p_a03111 except select * from same ), geometry as ( select mbr_hash_12 from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00006' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view ) as o on geometry.mbr_hash_12= o.mbr_hash_12) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160519_00001_nf_p_a03111 ) as o on geometry.mbr_hash_12 = o.mbr_hash_12) as receive where origin.mbr_hash_12 = receive.mbr_hash_12
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00006' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_p_a03111_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00006' and layer_nm = 'nf_p_a03111' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00006' as inspect_id, 'nf_p_a03111' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160519_00001_nf_p_a03111 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00006' and layer_nm = 'nf_p_a03111' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00007 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160519_00002' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00016_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160519_00016_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160519_00016_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00007' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160519_00016_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00007') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00007' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160519_00016_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00007') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00016_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00007' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00016_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00007' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00007' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00007' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160519_00016_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00007' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00008 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160519_00002' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00029_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160519_00029_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160519_00029_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00008' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160519_00029_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00008') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00008' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160519_00029_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00008') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00029_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00008' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00029_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00008' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00008' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00008' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160519_00029_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00008' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00009 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160519_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00002_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160519_00002_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160519_00002_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00009' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160519_00002_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00009') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00009' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160519_00002_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00009') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00002_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00009' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00002_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00009' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00009' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00009' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160519_00002_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00009' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00010 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160519_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00002_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160519_00002_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160519_00002_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160519_00002_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00010') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160519_00002_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00010') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00002_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160519_00002_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00010' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00010' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00010' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160519_00002_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00010' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00011 , layer_nm : nf_p_a03111 

view :create view extjob.nf_p_a03111_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160519_00001' and layer_nm = 'nf_p_a03111') as ext left join nfsd.nf_p_a03111 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160519_00002_nf_p_a03111) as e on o.mbr_hash_12 = e.mbr_hash_12 and o.ndid = e.ndid ),same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from geom_same_data) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160519_00002_nf_p_a03111) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.ndid from same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ),receive as (select o.ogc_fid as receive_ogc_fid, a.ndid from same_data as a inner join extjob.RD20160519_00002_nf_p_a03111 as o on a.ndid = o.ndid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00011' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.ndid = receive.ndid
edit_geom_data : with attr_same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160519_00002_nf_p_a03111) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00011') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00011' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.ndid from geo_edit as e inner join extjob.nf_p_a03111_view as o on e.ndid = o.ndid) as origin, (select ogc_fid as receive_ogc_fid,e.ndid from geo_edit as e inner join extjob.RD20160519_00002_nf_p_a03111 as o on e.ndid = o.ndid) as edit where origin.ndid = edit.ndid
edit_feature_data : with same as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00011') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view except select * from same ), em as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160519_00002_nf_p_a03111 except select * from same ), geometry as ( select mbr_hash_12 from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00011' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view ) as o on geometry.mbr_hash_12= o.mbr_hash_12) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160519_00002_nf_p_a03111 ) as o on geometry.mbr_hash_12 = o.mbr_hash_12) as receive where origin.mbr_hash_12 = receive.mbr_hash_12
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00011' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_p_a03111_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00011' and layer_nm = 'nf_p_a03111' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00011' as inspect_id, 'nf_p_a03111' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160519_00002_nf_p_a03111 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00011' and layer_nm = 'nf_p_a03111' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00012 , layer_nm : nf_l_a01000 

view :create view extjob.nf_l_a01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160519_00001' and layer_nm = 'nf_l_a01000') as ext left join nfsd.nf_l_a01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select rbid,rddv,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view) as o inner join (select rbid,rddv,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160519_00002_nf_l_a01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_length between o.geom_length*0.95 and o.geom_length*1.05 ),same_data as (select o.* from (select rbid,rddv from geom_same_data) as o inner join (select rbid,rddv from extjob.RD20160519_00002_nf_l_a01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.rbid from same_data as a inner join extjob.nf_l_a01000_view as o on a.rbid = o.rbid ),receive as (select o.ogc_fid as receive_ogc_fid, a.rbid from same_data as a inner join extjob.RD20160519_00002_nf_l_a01000 as o on a.rbid = o.rbid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00012' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.rbid = receive.rbid
edit_geom_data : with attr_same_data as (select o.* from (select rbid,rddv from extjob.nf_l_a01000_view) as o inner join (select rbid,rddv from extjob.RD20160519_00002_nf_l_a01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,rbid,rddv from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00012') as s inner join extjob.nf_l_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_l_a01000_view as o on a.rbid = o.rbid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00012' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.rbid from geo_edit as e inner join extjob.nf_l_a01000_view as o on e.rbid = o.rbid) as origin, (select ogc_fid as receive_ogc_fid,e.rbid from geo_edit as e inner join extjob.RD20160519_00002_nf_l_a01000 as o on e.rbid = o.rbid) as edit where origin.rbid = edit.rbid
edit_feature_data : with same as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00012') as s inner join extjob.nf_l_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view except select * from same ), em as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160519_00002_nf_l_a01000 except select * from same ), geometry as ( select mbr_hash_12,geom_length from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_length = om.geom_length) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00012' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_length from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_length)=(o.mbr_hash_12,o.geom_length)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_length from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160519_00002_nf_l_a01000 ) as o on (geometry.mbr_hash_12,geometry.geom_length)=(o.mbr_hash_12,o.geom_length)) as receive where (origin.mbr_hash_12,origin.geom_length) = (receive.mbr_hash_12,receive.geom_length)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00012' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_l_a01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00012' and layer_nm = 'nf_l_a01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00012' as inspect_id, 'nf_l_a01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160519_00002_nf_l_a01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00012' and layer_nm = 'nf_l_a01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00013 , layer_nm : nf_p_a03111 

view :create view extjob.nf_p_a03111_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160519_00001' and layer_nm = 'nf_p_a03111') as ext left join nfsd.nf_p_a03111 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160519_00002_nf_p_a03111) as e on o.mbr_hash_12 = e.mbr_hash_12 and o.ndid = e.ndid ),same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from geom_same_data) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160519_00002_nf_p_a03111) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.ndid from same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ),receive as (select o.ogc_fid as receive_ogc_fid, a.ndid from same_data as a inner join extjob.RD20160519_00002_nf_p_a03111 as o on a.ndid = o.ndid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00013' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.ndid = receive.ndid
edit_geom_data : with attr_same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160519_00002_nf_p_a03111) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00013') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00013' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.ndid from geo_edit as e inner join extjob.nf_p_a03111_view as o on e.ndid = o.ndid) as origin, (select ogc_fid as receive_ogc_fid,e.ndid from geo_edit as e inner join extjob.RD20160519_00002_nf_p_a03111 as o on e.ndid = o.ndid) as edit where origin.ndid = edit.ndid
edit_feature_data : with same as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00013') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view except select * from same ), em as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160519_00002_nf_p_a03111 except select * from same ), geometry as ( select mbr_hash_12 from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00013' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view ) as o on geometry.mbr_hash_12= o.mbr_hash_12) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160519_00002_nf_p_a03111 ) as o on geometry.mbr_hash_12 = o.mbr_hash_12) as receive where origin.mbr_hash_12 = receive.mbr_hash_12
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00013' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_p_a03111_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00013' and layer_nm = 'nf_p_a03111' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00013' as inspect_id, 'nf_p_a03111' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160519_00002_nf_p_a03111 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00013' and layer_nm = 'nf_p_a03111' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 19) , inspect_id : AD20160519_00014 , layer_nm : nf_p_a03111 

view :create view extjob.nf_p_a03111_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160519_00001' and layer_nm = 'nf_p_a03111') as ext left join nfsd.nf_p_a03111 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160519_00002_nf_p_a03111) as e on o.mbr_hash_12 = e.mbr_hash_12 and o.ndid = e.ndid ),same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from geom_same_data) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160519_00002_nf_p_a03111) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.ndid from same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ),receive as (select o.ogc_fid as receive_ogc_fid, a.ndid from same_data as a inner join extjob.RD20160519_00002_nf_p_a03111 as o on a.ndid = o.ndid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160519_00014' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.ndid = receive.ndid
edit_geom_data : with attr_same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160519_00002_nf_p_a03111) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00014') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00014' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.ndid from geo_edit as e inner join extjob.nf_p_a03111_view as o on e.ndid = o.ndid) as origin, (select ogc_fid as receive_ogc_fid,e.ndid from geo_edit as e inner join extjob.RD20160519_00002_nf_p_a03111 as o on e.ndid = o.ndid) as edit where origin.ndid = edit.ndid
edit_feature_data : with same as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160519_00014') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view except select * from same ), em as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160519_00002_nf_p_a03111 except select * from same ), geometry as ( select mbr_hash_12 from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00014' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view ) as o on geometry.mbr_hash_12= o.mbr_hash_12) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160519_00002_nf_p_a03111 ) as o on geometry.mbr_hash_12 = o.mbr_hash_12) as receive where origin.mbr_hash_12 = receive.mbr_hash_12
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160519_00014' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_p_a03111_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00014' and layer_nm = 'nf_p_a03111' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160519_00014' as inspect_id, 'nf_p_a03111' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160519_00002_nf_p_a03111 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160519_00014' and layer_nm = 'nf_p_a03111' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 20) , inspect_id : AD20160520_00001 , layer_nm : nf_l_a01000 

view :create view extjob.nf_l_a01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160519_00001' and layer_nm = 'nf_l_a01000') as ext left join nfsd.nf_l_a01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select rbid,rddv,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view) as o inner join (select rbid,rddv,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160519_00002_nf_l_a01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_length between o.geom_length*0.95 and o.geom_length*1.05 ),same_data as (select o.* from (select rbid,rddv from geom_same_data) as o inner join (select rbid,rddv from extjob.RD20160519_00002_nf_l_a01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.rbid from same_data as a inner join extjob.nf_l_a01000_view as o on a.rbid = o.rbid ),receive as (select o.ogc_fid as receive_ogc_fid, a.rbid from same_data as a inner join extjob.RD20160519_00002_nf_l_a01000 as o on a.rbid = o.rbid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160520_00001' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.rbid = receive.rbid
edit_geom_data : with attr_same_data as (select o.* from (select rbid,rddv from extjob.nf_l_a01000_view) as o inner join (select rbid,rddv from extjob.RD20160519_00002_nf_l_a01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,rbid,rddv from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160520_00001') as s inner join extjob.nf_l_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_l_a01000_view as o on a.rbid = o.rbid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00001' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.rbid from geo_edit as e inner join extjob.nf_l_a01000_view as o on e.rbid = o.rbid) as origin, (select ogc_fid as receive_ogc_fid,e.rbid from geo_edit as e inner join extjob.RD20160519_00002_nf_l_a01000 as o on e.rbid = o.rbid) as edit where origin.rbid = edit.rbid
edit_feature_data : with same as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160520_00001') as s inner join extjob.nf_l_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view except select * from same ), em as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160519_00002_nf_l_a01000 except select * from same ), geometry as ( select mbr_hash_12,geom_length from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_length = om.geom_length) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00001' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_length from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_length)=(o.mbr_hash_12,o.geom_length)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_length from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160519_00002_nf_l_a01000 ) as o on (geometry.mbr_hash_12,geometry.geom_length)=(o.mbr_hash_12,o.geom_length)) as receive where (origin.mbr_hash_12,origin.geom_length) = (receive.mbr_hash_12,receive.geom_length)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00001' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_l_a01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160520_00001' and layer_nm = 'nf_l_a01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160520_00001' as inspect_id, 'nf_l_a01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160519_00002_nf_l_a01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160520_00001' and layer_nm = 'nf_l_a01000' ) as add
=======
data : PyQt4.QtCore.QDate(2016, 5, 20) , inspect_id : AD20160520_00001 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160520_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160520_00001_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160520_00001_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160520_00001_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160520_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160520_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160520_00001') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160520_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160520_00001') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160520_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160520_00001_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160520_00001' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160520_00001' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160520_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160520_00001' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 20) , inspect_id : AD20160520_00002 , layer_nm : nf_l_a01000 

view :create view extjob.nf_l_a01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160520_00001' and layer_nm = 'nf_l_a01000') as ext left join nfsd.nf_l_a01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select rbid,rddv,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view) as o inner join (select rbid,rddv,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160520_00001_nf_l_a01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_length between o.geom_length*0.95 and o.geom_length*1.05 ),same_data as (select o.* from (select rbid,rddv from geom_same_data) as o inner join (select rbid,rddv from extjob.RD20160520_00001_nf_l_a01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.rbid from same_data as a inner join extjob.nf_l_a01000_view as o on a.rbid = o.rbid ),receive as (select o.ogc_fid as receive_ogc_fid, a.rbid from same_data as a inner join extjob.RD20160520_00001_nf_l_a01000 as o on a.rbid = o.rbid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160520_00002' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.rbid = receive.rbid
edit_geom_data : with attr_same_data as (select o.* from (select rbid,rddv from extjob.nf_l_a01000_view) as o inner join (select rbid,rddv from extjob.RD20160520_00001_nf_l_a01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,rbid,rddv from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160520_00002') as s inner join extjob.nf_l_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_l_a01000_view as o on a.rbid = o.rbid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00002' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.rbid from geo_edit as e inner join extjob.nf_l_a01000_view as o on e.rbid = o.rbid) as origin, (select ogc_fid as receive_ogc_fid,e.rbid from geo_edit as e inner join extjob.RD20160520_00001_nf_l_a01000 as o on e.rbid = o.rbid) as edit where origin.rbid = edit.rbid
edit_feature_data : with same as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160520_00002') as s inner join extjob.nf_l_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view except select * from same ), em as (select rbid,rddv, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160520_00001_nf_l_a01000 except select * from same ), geometry as ( select mbr_hash_12,geom_length from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_length = om.geom_length) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00002' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_length from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.nf_l_a01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_length)=(o.mbr_hash_12,o.geom_length)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_length from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_length(wkb_geometry) as numeric), 1) as geom_length from extjob.RD20160520_00001_nf_l_a01000 ) as o on (geometry.mbr_hash_12,geometry.geom_length)=(o.mbr_hash_12,o.geom_length)) as receive where (origin.mbr_hash_12,origin.geom_length) = (receive.mbr_hash_12,receive.geom_length)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00002' as inspect_id, 'nf_l_a01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_l_a01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160520_00002' and layer_nm = 'nf_l_a01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160520_00002' as inspect_id, 'nf_l_a01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160520_00001_nf_l_a01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160520_00002' and layer_nm = 'nf_l_a01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 20) , inspect_id : AD20160520_00003 , layer_nm : nf_p_a03111 

view :create view extjob.nf_p_a03111_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160520_00001' and layer_nm = 'nf_p_a03111') as ext left join nfsd.nf_p_a03111 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160520_00001_nf_p_a03111) as e on o.mbr_hash_12 = e.mbr_hash_12 and o.ndid = e.ndid ),same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from geom_same_data) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160520_00001_nf_p_a03111) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.ndid from same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ),receive as (select o.ogc_fid as receive_ogc_fid, a.ndid from same_data as a inner join extjob.RD20160520_00001_nf_p_a03111 as o on a.ndid = o.ndid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160520_00003' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.ndid = receive.ndid
edit_geom_data : with attr_same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160520_00001_nf_p_a03111) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160520_00003') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00003' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.ndid from geo_edit as e inner join extjob.nf_p_a03111_view as o on e.ndid = o.ndid) as origin, (select ogc_fid as receive_ogc_fid,e.ndid from geo_edit as e inner join extjob.RD20160520_00001_nf_p_a03111 as o on e.ndid = o.ndid) as edit where origin.ndid = edit.ndid
edit_feature_data : with same as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160520_00003') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view except select * from same ), em as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160520_00001_nf_p_a03111 except select * from same ), geometry as ( select mbr_hash_12 from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00003' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view ) as o on geometry.mbr_hash_12= o.mbr_hash_12) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160520_00001_nf_p_a03111 ) as o on geometry.mbr_hash_12 = o.mbr_hash_12) as receive where origin.mbr_hash_12 = receive.mbr_hash_12
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00003' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_p_a03111_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160520_00003' and layer_nm = 'nf_p_a03111' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160520_00003' as inspect_id, 'nf_p_a03111' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160520_00001_nf_p_a03111 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160520_00003' and layer_nm = 'nf_p_a03111' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 20) , inspect_id : AD20160520_00004 , layer_nm : nf_p_a03111 

view :create view extjob.nf_p_a03111_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160520_00001' and layer_nm = 'nf_p_a03111') as ext left join nfsd.nf_p_a03111 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid,st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160520_00001_nf_p_a03111) as e on o.mbr_hash_12 = e.mbr_hash_12 and o.ndid = e.ndid ),same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from geom_same_data) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160520_00001_nf_p_a03111) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.ndid from same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ),receive as (select o.ogc_fid as receive_ogc_fid, a.ndid from same_data as a inner join extjob.RD20160520_00001_nf_p_a03111 as o on a.ndid = o.ndid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160520_00004' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.ndid = receive.ndid
edit_geom_data : with attr_same_data as (select o.* from (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.nf_p_a03111_view) as o inner join (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from extjob.RD20160520_00001_nf_p_a03111) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160520_00004') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_p_a03111_view as o on a.ndid = o.ndid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00004' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.ndid from geo_edit as e inner join extjob.nf_p_a03111_view as o on e.ndid = o.ndid) as origin, (select ogc_fid as receive_ogc_fid,e.ndid from geo_edit as e inner join extjob.RD20160520_00001_nf_p_a03111 as o on e.ndid = o.ndid) as edit where origin.ndid = edit.ndid
edit_feature_data : with same as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160520_00004') as s inner join extjob.nf_p_a03111_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view except select * from same ), em as (select ndid,hjcd_1,hjcd_2,name,nddv,cnlk,rest,ad_ndid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160520_00001_nf_p_a03111 except select * from same ), geometry as ( select mbr_hash_12 from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00004' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.nf_p_a03111_view ) as o on geometry.mbr_hash_12= o.mbr_hash_12) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12 from geometry inner join (select ogc_fid, st_geohash(ST_Transform(wkb_geometry, 4326), 12) as mbr_hash_12 from extjob.RD20160520_00001_nf_p_a03111 ) as o on geometry.mbr_hash_12 = o.mbr_hash_12) as receive where origin.mbr_hash_12 = receive.mbr_hash_12
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00004' as inspect_id, 'nf_p_a03111' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_p_a03111_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160520_00004' and layer_nm = 'nf_p_a03111' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160520_00004' as inspect_id, 'nf_p_a03111' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160520_00001_nf_p_a03111 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160520_00004' and layer_nm = 'nf_p_a03111' ) as add
>>>>>>> b9d5b7f6558ee4d151dcdeb9e3813eaf25142adb

data : PyQt4.QtCore.QDate(2016, 5, 20) , inspect_id : AD20160520_00005 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160520_00002' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160520_00002_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160520_00002_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160520_00002_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160520_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160520_00002_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160520_00005') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160520_00002_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160520_00005') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160520_00002_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160520_00002_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160520_00005' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160520_00005' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160520_00005' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160520_00002_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160520_00005' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 5, 31) , inspect_id : AD20160531_00001 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160520_00002' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160520_00002_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 ),same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160520_00002_nf_a_b01000) as e on (o.*) = (e.*)),origin as ( select o.ogc_fid as origin_ogc_fid, a.bdid from same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid from same_data as a inner join extjob.RD20160520_00002_nf_a_b01000 as o on a.bdid = o.bdid ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160531_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160520_00002_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160531_00001') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160531_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160520_00002_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160531_00001') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,nmly,pnu,useapr_day,rdnm,rn_cd,bonu,bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160520_00002_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area = om.geom_area) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160531_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160520_00002_nf_a_b01000 ) as o on (geometry.mbr_hash_12,geometry.geom_area)=(o.mbr_hash_12,o.geom_area)) as receive where (origin.mbr_hash_12,origin.geom_area) = (receive.mbr_hash_12,receive.geom_area)
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160531_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160531_00001' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160531_00001' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160520_00002_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160531_00001' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 6, 15) , inspect_id : AD20160615_00001 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160525_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,create_dttm,delete_dttm,announce_dttm,realworld_dttm,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,create_dttm,delete_dttm,announce_dttm,realworld_dttm,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160526_00007_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 and o.bdid = e.bdid ),same_data as (select o.* from (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,create_dttm,delete_dttm,announce_dttm,realworld_dttm,mbr_hash_12 from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,create_dttm,delete_dttm,announce_dttm,realworld_dttm,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160526_00007_nf_a_b01000) as e on (o.*) = (e.*)),origin as (select o.ogc_fid as origin_ogc_fid, a.bdid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, bdid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.nf_a_b01000_view) as o on a.bdid = o.bdid and a.mbr_hash_12 = o.mbr_hash_12 ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, bdid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160526_00007_nf_a_b01000) as o on a.bdid = o.bdid and a.mbr_hash_12 = o.mbr_hash_12 ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160615_00001' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid and origin.mbr_hash_12 = receive.mbr_hash_12
data : PyQt4.QtCore.QDate(2016, 6, 15) , inspect_id : AD20160615_00002 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160525_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160526_00007_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 and o.bdid = e.bdid ),same_data as (select o.* from (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,mbr_hash_12 from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160526_00007_nf_a_b01000) as e on (o.*) = (e.*)),origin as (select o.ogc_fid as origin_ogc_fid, a.bdid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, bdid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.nf_a_b01000_view) as o on a.bdid = o.bdid and a.mbr_hash_12 = o.mbr_hash_12 ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, bdid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160526_00007_nf_a_b01000) as o on a.bdid = o.bdid and a.mbr_hash_12 = o.mbr_hash_12 ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160615_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid and origin.mbr_hash_12 = receive.mbr_hash_12
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160526_00007_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160615_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160615_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160526_00007_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160615_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160526_00007_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area between om.geom_area*0.95 and om.geom_area*1.05 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid,receive_ogc_fid,mod_type)select 'AD20160615_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160526_00007_nf_a_b01000 ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as receive where receive.mbr_hash_12=origin.mbr_hash_12 and receive.geom_area between origin.geom_area*0.95 and origin.geom_area*1.05
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160615_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160615_00002' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160615_00002' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160526_00007_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160615_00002' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 6, 21) , inspect_id : AD20160621_00001 , layer_nm : nf_a_a01000 

view :create view extjob.nf_a_a01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160621_00001' and layer_nm = 'nf_a_a01000') as ext left join nfsd.nf_a_a01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_a01000_view) as o inner join (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160621_00001_nf_a_a01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 and o.rbid = e.rbid ),same_data as (select o.* from (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,mbr_hash_12 from geom_same_data) as o inner join (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160621_00001_nf_a_a01000) as e on (o.*) = (e.*)),origin as (select o.ogc_fid as origin_ogc_fid, a.rbid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, rbid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.nf_a_a01000_view) as o on a.rbid = o.rbid and a.mbr_hash_12 = o.mbr_hash_12 ),receive as (select o.ogc_fid as receive_ogc_fid, a.rbid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, rbid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160621_00001_nf_a_a01000) as o on a.rbid = o.rbid and a.mbr_hash_12 = o.mbr_hash_12 ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160621_00001' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.rbid = receive.rbid and origin.mbr_hash_12 = receive.mbr_hash_12
edit_geom_data : with attr_same_data as (select o.* from (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest from extjob.nf_a_a01000_view) as o inner join (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest from extjob.RD20160621_00001_nf_a_a01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160621_00001') as s inner join extjob.nf_a_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_a01000_view as o on a.rbid = o.rbid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160621_00001' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.rbid from geo_edit as e inner join extjob.nf_a_a01000_view as o on e.rbid = o.rbid) as origin, (select ogc_fid as receive_ogc_fid,e.rbid from geo_edit as e inner join extjob.RD20160621_00001_nf_a_a01000 as o on e.rbid = o.rbid) as edit where origin.rbid = edit.rbid
edit_feature_data : with same as (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160621_00001') as s inner join extjob.nf_a_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_a01000_view except select * from same ), em as (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160621_00001_nf_a_a01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area between om.geom_area*0.95 and om.geom_area*1.05 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid,receive_ogc_fid,mod_type)select 'AD20160621_00001' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_a01000_view ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160621_00001_nf_a_a01000 ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as receive where receive.mbr_hash_12=origin.mbr_hash_12 and receive.geom_area between origin.geom_area*0.95 and origin.geom_area*1.05
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160621_00001' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_a01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160621_00001' and layer_nm = 'nf_a_a01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160621_00001' as inspect_id, 'nf_a_a01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160621_00001_nf_a_a01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160621_00001' and layer_nm = 'nf_a_a01000' ) as add

data : PyQt4.QtCore.QDate(2016, 6, 21) , inspect_id : AD20160621_00002 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160621_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160621_00001_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 and o.bdid = e.bdid ),same_data as (select o.* from (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,mbr_hash_12 from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160621_00001_nf_a_b01000) as e on (o.*) = (e.*)),origin as (select o.ogc_fid as origin_ogc_fid, a.bdid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, bdid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.nf_a_b01000_view) as o on a.bdid = o.bdid and a.mbr_hash_12 = o.mbr_hash_12 ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, bdid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160621_00001_nf_a_b01000) as o on a.bdid = o.bdid and a.mbr_hash_12 = o.mbr_hash_12 ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160621_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid and origin.mbr_hash_12 = receive.mbr_hash_12
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160621_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160621_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160621_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160621_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160621_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160621_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area between om.geom_area*0.95 and om.geom_area*1.05 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid,receive_ogc_fid,mod_type)select 'AD20160621_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160621_00001_nf_a_b01000 ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as receive where receive.mbr_hash_12=origin.mbr_hash_12 and receive.geom_area between origin.geom_area*0.95 and origin.geom_area*1.05
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160621_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160621_00002' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160621_00002' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160621_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160621_00002' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 6, 21) , inspect_id : AD20160621_00004 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160621_00006' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160621_00005_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 and o.bdid = e.bdid ),same_data as (select o.* from (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,mbr_hash_12 from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160621_00005_nf_a_b01000) as e on (o.*) = (e.*)),origin as (select o.ogc_fid as origin_ogc_fid, a.bdid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, bdid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.nf_a_b01000_view) as o on a.bdid = o.bdid and a.mbr_hash_12 = o.mbr_hash_12 ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, bdid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160621_00005_nf_a_b01000) as o on a.bdid = o.bdid and a.mbr_hash_12 = o.mbr_hash_12 ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160621_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid and origin.mbr_hash_12 = receive.mbr_hash_12
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160621_00005_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160621_00004') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160621_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160621_00005_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160621_00004') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160621_00005_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area between om.geom_area*0.95 and om.geom_area*1.05 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid,receive_ogc_fid,mod_type)select 'AD20160621_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160621_00005_nf_a_b01000 ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as receive where receive.mbr_hash_12=origin.mbr_hash_12 and receive.geom_area between origin.geom_area*0.95 and origin.geom_area*1.05
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160621_00004' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160621_00004' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160621_00004' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160621_00005_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160621_00004' and layer_nm = 'nf_a_b01000' ) as add

data : PyQt4.QtCore.QDate(2016, 6, 22) , inspect_id : AD20160622_00001 , layer_nm : nf_a_a01000 

view :create view extjob.nf_a_a01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160621_00006' and layer_nm = 'nf_a_a01000') as ext left join nfsd.nf_a_a01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_a01000_view) as o inner join (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160621_00004_nf_a_a01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 and o.rbid = e.rbid ),same_data as (select o.* from (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,mbr_hash_12 from geom_same_data) as o inner join (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160621_00004_nf_a_a01000) as e on (o.*) = (e.*)),origin as (select o.ogc_fid as origin_ogc_fid, a.rbid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, rbid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.nf_a_a01000_view) as o on a.rbid = o.rbid and a.mbr_hash_12 = o.mbr_hash_12 ),receive as (select o.ogc_fid as receive_ogc_fid, a.rbid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, rbid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160621_00004_nf_a_a01000) as o on a.rbid = o.rbid and a.mbr_hash_12 = o.mbr_hash_12 ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160622_00001' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.rbid = receive.rbid and origin.mbr_hash_12 = receive.mbr_hash_12
edit_geom_data : with attr_same_data as (select o.* from (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest from extjob.nf_a_a01000_view) as o inner join (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest from extjob.RD20160621_00004_nf_a_a01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160622_00001') as s inner join extjob.nf_a_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_a01000_view as o on a.rbid = o.rbid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160622_00001' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.rbid from geo_edit as e inner join extjob.nf_a_a01000_view as o on e.rbid = o.rbid) as origin, (select ogc_fid as receive_ogc_fid,e.rbid from geo_edit as e inner join extjob.RD20160621_00004_nf_a_a01000 as o on e.rbid = o.rbid) as edit where origin.rbid = edit.rbid
edit_feature_data : with same as (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160622_00001') as s inner join extjob.nf_a_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_a01000_view except select * from same ), em as (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160621_00004_nf_a_a01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area between om.geom_area*0.95 and om.geom_area*1.05 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid,receive_ogc_fid,mod_type)select 'AD20160622_00001' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_a01000_view ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160621_00004_nf_a_a01000 ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as receive where receive.mbr_hash_12=origin.mbr_hash_12 and receive.geom_area between origin.geom_area*0.95 and origin.geom_area*1.05
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160622_00001' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_a01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160622_00001' and layer_nm = 'nf_a_a01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160622_00001' as inspect_id, 'nf_a_a01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160621_00004_nf_a_a01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160622_00001' and layer_nm = 'nf_a_a01000' ) as add

data : PyQt4.QtCore.QDate(2016, 6, 22) , inspect_id : AD20160622_00002 , layer_nm : nf_a_a01000 

view :create view extjob.nf_a_a01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160621_00006' and layer_nm = 'nf_a_a01000') as ext left join nfsd.nf_a_a01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_a01000_view) as o inner join (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160622_00001_nf_a_a01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 and o.rbid = e.rbid ),same_data as (select o.* from (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,mbr_hash_12 from geom_same_data) as o inner join (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160622_00001_nf_a_a01000) as e on (o.*) = (e.*)),origin as (select o.ogc_fid as origin_ogc_fid, a.rbid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, rbid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.nf_a_a01000_view) as o on a.rbid = o.rbid and a.mbr_hash_12 = o.mbr_hash_12 ),receive as (select o.ogc_fid as receive_ogc_fid, a.rbid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, rbid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160622_00001_nf_a_a01000) as o on a.rbid = o.rbid and a.mbr_hash_12 = o.mbr_hash_12 ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160622_00002' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.rbid = receive.rbid and origin.mbr_hash_12 = receive.mbr_hash_12
edit_geom_data : with attr_same_data as (select o.* from (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest from extjob.nf_a_a01000_view) as o inner join (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest from extjob.RD20160622_00001_nf_a_a01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160622_00002') as s inner join extjob.nf_a_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_a01000_view as o on a.rbid = o.rbid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160622_00002' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.rbid from geo_edit as e inner join extjob.nf_a_a01000_view as o on e.rbid = o.rbid) as origin, (select ogc_fid as receive_ogc_fid,e.rbid from geo_edit as e inner join extjob.RD20160622_00001_nf_a_a01000 as o on e.rbid = o.rbid) as edit where origin.rbid = edit.rbid
edit_feature_data : with same as (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160622_00002') as s inner join extjob.nf_a_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_a01000_view except select * from same ), em as (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160622_00001_nf_a_a01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area between om.geom_area*0.95 and om.geom_area*1.05 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid,receive_ogc_fid,mod_type)select 'AD20160622_00002' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_a01000_view ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160622_00001_nf_a_a01000 ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as receive where receive.mbr_hash_12=origin.mbr_hash_12 and receive.geom_area between origin.geom_area*0.95 and origin.geom_area*1.05
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160622_00002' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_a01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160622_00002' and layer_nm = 'nf_a_a01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160622_00002' as inspect_id, 'nf_a_a01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160622_00001_nf_a_a01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160622_00002' and layer_nm = 'nf_a_a01000' ) as add

data : PyQt4.QtCore.QDate(2016, 6, 22) , inspect_id : AD20160622_00001 , layer_nm : nf_a_a01000 

view :create view extjob.nf_a_a01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160622_00001' and layer_nm = 'nf_a_a01000') as ext left join nfsd.nf_a_a01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_a01000_view) as o inner join (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160622_00001_nf_a_a01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 and o.rbid = e.rbid ),same_data as (select o.* from (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,mbr_hash_12 from geom_same_data) as o inner join (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160622_00001_nf_a_a01000) as e on (o.*) = (e.*)),origin as (select o.ogc_fid as origin_ogc_fid, a.rbid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, rbid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.nf_a_a01000_view) as o on a.rbid = o.rbid and a.mbr_hash_12 = o.mbr_hash_12 ),receive as (select o.ogc_fid as receive_ogc_fid, a.rbid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, rbid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160622_00001_nf_a_a01000) as o on a.rbid = o.rbid and a.mbr_hash_12 = o.mbr_hash_12 ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160622_00001' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.rbid = receive.rbid and origin.mbr_hash_12 = receive.mbr_hash_12
edit_geom_data : with attr_same_data as (select o.* from (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest from extjob.nf_a_a01000_view) as o inner join (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest from extjob.RD20160622_00001_nf_a_a01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160622_00001') as s inner join extjob.nf_a_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_a01000_view as o on a.rbid = o.rbid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160622_00001' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.rbid from geo_edit as e inner join extjob.nf_a_a01000_view as o on e.rbid = o.rbid) as origin, (select ogc_fid as receive_ogc_fid,e.rbid from geo_edit as e inner join extjob.RD20160622_00001_nf_a_a01000 as o on e.rbid = o.rbid) as edit where origin.rbid = edit.rbid
edit_feature_data : with same as (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160622_00001') as s inner join extjob.nf_a_a01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_a01000_view except select * from same ), em as (select rbid,hjcd,round(uops, 3) as uops,round(tpsl, 3) as tpsl,round(mmsl, 3) as mmsl,round(fclt, 3) as fclt,rdnu,name,rddv,stpt,edpt,pvqt,dvyn,round(rdln, 3) as rdln,round(rvwd, 3) as rvwd,onsd,rdnm,round(area, 3) as area,rest, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160622_00001_nf_a_a01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area between om.geom_area*0.95 and om.geom_area*1.05 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid,receive_ogc_fid,mod_type)select 'AD20160622_00001' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_a01000_view ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160622_00001_nf_a_a01000 ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as receive where receive.mbr_hash_12=origin.mbr_hash_12 and receive.geom_area between origin.geom_area*0.95 and origin.geom_area*1.05
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160622_00001' as inspect_id, 'nf_a_a01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_a01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160622_00001' and layer_nm = 'nf_a_a01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160622_00001' as inspect_id, 'nf_a_a01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160622_00001_nf_a_a01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160622_00001' and layer_nm = 'nf_a_a01000' ) as add

data : PyQt4.QtCore.QDate(2016, 6, 22) , inspect_id : AD20160622_00002 , layer_nm : nf_a_b01000 

view :create view extjob.nf_a_b01000_view as SELECT origin.* FROM ( select * from extjob.extjob_objlist where extjob_objlist.extjob_id = 'EJ20160622_00001' and layer_nm = 'nf_a_b01000') as ext left join nfsd.nf_a_b01000 as origin on ext.ogc_fid = origin.ogc_fid
same_data : with geom_same_data as ( select o.* from (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160622_00001_nf_a_b01000) as e on o.mbr_hash_12 = e.mbr_hash_12 and e.geom_area between o.geom_area*0.95 and o.geom_area*1.05 and o.bdid = e.bdid ),same_data as (select o.* from (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,mbr_hash_12 from geom_same_data) as o inner join (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160622_00001_nf_a_b01000) as e on (o.*) = (e.*)),origin as (select o.ogc_fid as origin_ogc_fid, a.bdid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, bdid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.nf_a_b01000_view) as o on a.bdid = o.bdid and a.mbr_hash_12 = o.mbr_hash_12 ),receive as (select o.ogc_fid as receive_ogc_fid, a.bdid, a.mbr_hash_12 from same_data as a inner join (select ogc_fid, bdid,st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12 from extjob.RD20160622_00001_nf_a_b01000) as o on a.bdid = o.bdid and a.mbr_hash_12 = o.mbr_hash_12 ) insert into extjob.inspect_objlist( inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type )select 'AD20160622_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 's' as mod_type from origin, receive where origin.bdid = receive.bdid and origin.mbr_hash_12 = receive.mbr_hash_12
edit_geom_data : with attr_same_data as (select o.* from (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.nf_a_b01000_view) as o inner join (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn from extjob.RD20160622_00001_nf_a_b01000) as e on (o.*) = (e.*) ), same_data as( select wkb_geometry,bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160622_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), join_geom as ( select o.wkb_geometry, a.* from attr_same_data as a inner join extjob.nf_a_b01000_view as o on a.bdid = o.bdid ), geo_edit as ( select * from join_geom except select * from same_data) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160622_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'eg' as mod_type from (select ogc_fid as origin_ogc_fid,e.bdid from geo_edit as e inner join extjob.nf_a_b01000_view as o on e.bdid = o.bdid) as origin, (select ogc_fid as receive_ogc_fid,e.bdid from geo_edit as e inner join extjob.RD20160622_00001_nf_a_b01000 as o on e.bdid = o.bdid) as edit where origin.bdid = edit.bdid
edit_feature_data : with same as (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from (select origin_ogc_fid from extjob.inspect_objlist where mod_type = 's' and inspect_id = 'AD20160622_00002') as s inner join extjob.nf_a_b01000_view as o on s.origin_ogc_fid = o.ogc_fid), om as (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view except select * from same ), em as (select bdid,name,kind,serv,anno,round(nmly, 3) as nmly,pnu,useapr_day,rdnm,rn_cd,round(bonu, 3) as bonu,round(bunu, 3) as bunu,post,shp_alter,shp_his,poi_id,geoidn, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160622_00001_nf_a_b01000 except select * from same ), geometry as ( select mbr_hash_12,geom_area from ( select om.* from om inner join em on em.mbr_hash_12 = om.mbr_hash_12 and em.geom_area between om.geom_area*0.95 and om.geom_area*1.05 ) as t) insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid,receive_ogc_fid,mod_type)select 'AD20160622_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, receive_ogc_fid, 'ef' as mod_type from (select ogc_fid as origin_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.nf_a_b01000_view ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as origin, (select ogc_fid as receive_ogc_fid, o.mbr_hash_12, o.geom_area from geometry inner join (select ogc_fid, st_geohash(ST_Transform(st_centroid(st_envelope(wkb_geometry)), 4326), 12) as mbr_hash_12, round( CAST(st_area(wkb_geometry) as numeric), 1) as geom_area from extjob.RD20160622_00001_nf_a_b01000 ) as o on geometry.mbr_hash_12=o.mbr_hash_12 and geometry.geom_area between o.geom_area*0.95 and o.geom_area*1.05) as receive where receive.mbr_hash_12=origin.mbr_hash_12 and receive.geom_area between origin.geom_area*0.95 and origin.geom_area*1.05
rm_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type) select 'AD20160622_00002' as inspect_id, 'nf_a_b01000' as layer_nm, origin_ogc_fid, 0 as receive_ogc_fid, 'r' as mod_type from (select ogc_fid as origin_ogc_fid from extjob.nf_a_b01000_view except select origin_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160622_00002' and layer_nm = 'nf_a_b01000' ) as rm
add_data : insert into extjob.inspect_objlist(inspect_id, layer_nm, origin_ogc_fid, receive_ogc_fid, mod_type ) select 'AD20160622_00002' as inspect_id, 'nf_a_b01000' as layer_nm, 0 as origin_ogc_fid, receive_ogc_fid, 'a' as mod_type from (select ogc_fid as receive_ogc_fid from extjob.RD20160622_00001_nf_a_b01000 except select receive_ogc_fid from extjob.inspect_objlist where inspect_id = 'AD20160622_00002' and layer_nm = 'nf_a_b01000' ) as add

